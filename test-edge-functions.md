# วิธีทดสอบ Edge Functions หลัง Deploy

## 1. ทดสอบ parse-jd-document

### ผ่าน Supabase Dashboard
1. ไปที่ Supabase Dashboard → Edge Functions
2. เลือก `parse-jd-document`
3. กด "Invoke Function"
4. ใส่ Test Payload:

```json
{
  "documentText": "ตำแหน่ง: Software Engineer\nแผนก: IT\nเงินเดือน: 30,000-40,000 บาท\nสถานที่ทำงาน: สำนักงานใหญ่ สุรวงศ์\nการศึกษา: ปริญญาตรี สาขาวิทยาการคอมพิวเตอร์\nประสบการณ์: 2 ปี\nเพศ: ไม่ระบุ",
  "documentType": "jd"
}
```

5. ดูผลลัพธ์ว่า Parse ได้ถูกต้องหรือไม่

### ผ่าน Application
1. ไปที่หน้า **Job Requisitions**
2. อัพโหลดไฟล์ JD (PDF)
3. กดปุ่ม **"Parse JD ด้วย AI"** (ปุ่มสีม่วง-ชมพู)
4. รอ 1-3 วินาที
5. ตรวจสอบว่าฟอร์มถูกกรอกอัตโนมัติหรือไม่

**ผลลัพธ์ที่คาดหวัง:**
- ✅ ตำแหน่งงาน ถูกกรอก
- ✅ แผนก ถูกกรอก
- ✅ เงินเดือน ถูกกรอก
- ✅ สถานที่ทำงาน ถูกกรอก
- ✅ การศึกษา ถูกกรอก
- ✅ ประสบการณ์ ถูกกรอก
- ✅ ทักษะอื่นๆ ถูกกรอก

## 2. ทดสอบ calculate-fit-score

### ผ่าน Application
1. ไปที่หน้า **Candidates**
2. ดูคอลัมน์ **"AI Fit Score"**
3. ตรวจสอบว่ามีคะแนนแสดงหรือไม่

**ผลลัพธ์ที่คาดหวัง:**
- ✅ แสดงคะแนน 0-100
- ✅ มีสีตามระดับ (แดง < 50, เหลือง 50-74, เขียว ≥ 75)
- ✅ แสดงเหตุผลเมื่อ hover

## 3. ทดสอบ parse-resume

### ผ่าน Application
1. ไปที่หน้า **Job Application** (หน้าสมัครงาน)
2. อัพโหลดไฟล์ Resume (PDF)
3. รอ 1-3 วินาที
4. ตรวจสอบว่าฟอร์มถูกกรอกอัตโนมัติหรือไม่

**ผลลัพธ์ที่คาดหวัง:**
- ✅ ชื่อ-นามสกุล ถูกกรอก
- ✅ อีเมล ถูกกรอก
- ✅ เบอร์โทร ถูกกรอก
- ✅ ตำแหน่งที่สมัคร ถูกกรอก
- ✅ ประสบการณ์ ถูกกรอก
- ✅ การศึกษา ถูกกรอก
- ✅ ทักษะ ถูกกรอก

## การแก้ปัญหา

### ถ้า Parse ไม่ได้
1. เปิด Browser Console (F12)
2. ดู Error message
3. ตรวจสอบ:
   - ✅ Edge Function ถูก Deploy แล้ว
   - ✅ OPENAI_API_KEY ตั้งค่าแล้ว
   - ✅ CORS headers ถูกต้อง

### ถ้า Parse ได้แต่ข้อมูลไม่ถูกต้อง
1. ตรวจสอบว่าใช้ Model ใหม่แล้ว (`gemini-2.0-flash-thinking-exp:free`)
2. ลองเพิ่ม temperature ให้ต่ำลง (0.05)
3. ปรับ System Prompt ให้ละเอียดขึ้น

### ถ้าช้าเกินไป (> 10 วินาที)
1. ตรวจสอบ OpenRouter API status
2. ลองเปลี่ยนกลับเป็น `gemini-2.0-flash-exp:free` (เร็วกว่า)
3. ตรวจสอบขนาดไฟล์ (ไม่ควรเกิน 5MB)

## ตัวอย่างผลลัพธ์ที่ดี

### Parse JD
```json
{
  "success": true,
  "data": {
    "position": "Software Engineer",
    "department": "IT",
    "salary": "30,000-40,000 บาท",
    "work_location": "สำนักงานใหญ่ สุรวงศ์",
    "min_education": "ปริญญาตรี",
    "field_of_study": "วิทยาการคอมพิวเตอร์",
    "min_experience": "2 ปี",
    "gender": "ไม่ระบุ"
  }
}
```

### Calculate Fit Score
```json
{
  "success": true,
  "data": {
    "score": 85,
    "reasoning": "ผู้สมัครมีคุณสมบัติตรงตามที่ต้องการ มีประสบการณ์ 3 ปี และมีทักษะที่เกี่ยวข้อง"
  }
}
```

## เปรียบเทียบก่อน-หลัง Upgrade

### ก่อน (Gemini 2.0 Flash)
- ความแม่นยำ: ~75%
- Parse ได้ 6-7 ฟิลด์จาก 10 ฟิลด์
- บางครั้งข้อมูลผิด

### หลัง (Gemini 2.0 Flash Thinking)
- ความแม่นยำ: ~90%
- Parse ได้ 9-10 ฟิลด์จาก 10 ฟิลด์
- ข้อมูลถูกต้องมากขึ้น
- เข้าใจบริบทภาษาไทยดีขึ้น
